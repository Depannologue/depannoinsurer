<ion-header  >
  <ion-navbar>
    <ion-title >
      Interventions
    </ion-title>
  </ion-navbar>
</ion-header >
<ion-content padding class="about" style="background-color:#f1f1f1">
  <ion-list >
    <ion-row responsive-sm responsive-md responsive-lg wrap >
      <ion-col width-33 *ngFor="let intervention of openedInterventions" >
        <ion-card style="background-color:rgba(255,255,255,0.8)" >
          <ion-item style="background-color:rgba(0,0,0,0)">
            <ion-icon secondary name="contact" item-left large ></ion-icon>
            <h2 primary>Intervention N°{{intervention.id}}</h2>
            <p><b>Reférence client</b> : 074TEST </p>
            <p><b>Nom</b> : {{intervention.customer.lastname}} </p>
            <p><b>Prenom</b> : {{intervention.customer.firstname}} </p>
            <p><b>Date</b> : {{intervention.intervention_date | date: 'dd/MM/yyyy'}}</p>
            <p><b>Heure</b> : {{intervention.intervention_date | date: 'HH'}}H{{intervention.intervention_date | date: 'mm'}}</p>
            <p><b>Adresse</b>:</p>
            <p>{{intervention.address.address1}} </p>
            <p>{{intervention.address.zipcode}} {{intervention.address.city}}</p>
            <a href="tel:intervention.customer.phone_number.trim().replace('+33', '0')">
              <button small primary>
                <ion-icon name='call'></ion-icon>
                : {{intervention.customer.phone_number.trim().replace('+33', '0')}}
              </button>
            </a>
            <br>
            <a href="mailto:intervention.customer.email">
              <button small primary  >
                <ion-icon name='mail'></ion-icon>
                : Email
              </button>
            </a>
          </ion-item>
          <ion-item style="background-color:rgba(0,0,0,0)">
            <ion-icon InterventionProfessionIcon name="build" item-left large ></ion-icon>
            <p><b>Profession</b> : {{getProfessionNameWithId(intervention.intervention_type.profession_id)}} </p>
            <p><b>Intervention</b> : {{intervention.intervention_type.short_description}} </p>
          </ion-item>

          <ion-item style="background-color:rgba(0,0,0,0)" *ngIf="intervention.state == 'pending_pro_validation'">
            <ion-icon primary name="time" item-left large></ion-icon>
            En attente de validation
          </ion-item>
          <ion-item style="background-color:rgba(0,0,0,0)" *ngIf="intervention.state == 'pro_on_the_road'">
            <ion-icon primary name="car" item-left large></ion-icon>
            <h2>Dépanneur en route</h2>
            <p><button (click)="openInterventionMapPage(intervention)">
              <ion-icon name="locate"></ion-icon>
              Suivre son arrivée
            </button></p>
          </ion-item>
          <ion-item style="background-color:rgba(0,0,0,0)" *ngIf="intervention.state == 'closed'">
            <ion-icon secondary name="checkmark" item-left large></ion-icon>
            <h2>Intervention terminée</h2>
          </ion-item>

          <ion-item style="background-color:rgba(255,255,255,0.5)">
            <button item-right (click)="openInterventionDetailsPage(intervention)"><ion-icon name="add"></ion-icon> d'informations
            </button>
          </ion-item>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-list>

  <ion-list >
    <ion-list-header style="background-color:rgba(255,255,255,0.85)">
    <h3>Historique</h3>
    </ion-list-header>
    <ion-item style="background-color:rgba(255,255,255,0.85)">
      <ion-icon name="calendar" item-left></ion-icon>
        Filtrer par date
    </ion-item>
    <ion-row style="background-color:rgba(255,255,255,0.85)" responsive-sm responsive-md responsive-lg wrap>
      <ion-col width-33>
        <ion-item style="background-color:rgba(0,0,0,0.15)" >
          <ion-label stacked primary><b>Date de debut</b></ion-label>
          <ion-input [(ngModel)]="date1" type="date" placeholder="JJ/MM/AAAA"></ion-input>
        </ion-item>
      </ion-col>
      <ion-col width-33>
       <ion-item style="background-color:rgba(0,0,0,0.15)">
          <ion-label stacked primary><b>Date de fin</b></ion-label>
          <ion-input [(ngModel)]="date2" type="date" placeholder="JJ/MM/AAAA"></ion-input>
        </ion-item>
      </ion-col>
      <ion-col width-33 >
        <button (click)="getClosedBetweenTime()">
          Valider
        </button>
        <button (click)="getClosed()">
          Supprimer filtre
        </button>
      </ion-col>
    </ion-row>
    <ion-item  style="background-color:rgba(255,255,255,0.85)" *ngFor="let intervention of closedInterventions">
      <div item-right>
        <ion-note>
          <p>{{intervention.intervention_date | date: 'dd/MM/yyyy'}}</p>
          <p>{{intervention.intervention_date | date: 'HH'}}:{{intervention.intervention_date | date: 'mm'}}</p>
        </ion-note>
        <p>
          <button item-right (click)="openInterventionDetailsPage(intervention)">
          <ion-icon name="add"></ion-icon>
          details
          </button>
        </p>
      </div>
      <h2 primary>Intervention N°{{intervention.id}}</h2>
      <h3><b>Client</b> :
        <p>{{intervention.customer.lastname}} {{intervention.customer.firstname}}</p></h3>
      <h3><b>Intervention</b> :
        <p>{{getProfessionNameWithId(intervention.intervention_type.profession_id)}}</p>
        <p>{{intervention.intervention_type.short_description}}</p></h3>
    </ion-item>
  </ion-list>


</ion-content>
